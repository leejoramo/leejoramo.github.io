<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">

    <meta name="twitter:card" content="summary">
    <meta property="og:type" content="website">
    <meta name="twitter:title" property="og:title" itemprop="title name" content="      
      
         How I Extended Markdown for Hugo 
      ">
 <meta name="description" content="Lee&#39;s Blog">
 <meta name="twitter:description" property="og:description" itemprop="description" content="Lee&#39;s Blog">
    <base href="">
   

    <title>
      
      
         How I Extended Markdown for Hugo 
      
    </title>
    <link rel="canonical" href="/2017/03/29/how-i-extended-markdown-for-hugo/">

    <style>
body {
  font: 17px / 24px; 
  font-family: "Avenir Next", "Avenir", "Helvetica Neue", Helvetica, Arial, sans-serif;
  text-rendering: optimizeLegibility;
  font-variant-ligatures: common-ligatures;
  font-feature-settings: "liga";
  -moz-osx-font-smoothing: grayscale;
  -moz-font-feature-settings: “liga” on;
  color: #111111;
  word-wrap: break-word;
  background-color: rgb(254, 254, 250);
  background: linear-gradient(to right, #d0d03a 1%,#ffffff 1.5%);
  padding: 0 1.5%;
}

.clear {width: 100%;clear: both;float: none;display: block;height: 0}

.small,
.caption {font-size: 13px;
  font-family: "Avenir Next", "Avenir", "Helvetica Neue", Helvetica, Arial, sans-serif;color: #999;font-weight: 500;}

.caption {
  line-height: 18px;
  display: block;
  margin: 9px auto 24px;
  max-width: 600px;
  font-style: normal;
}

 
.wide.left .caption {margin-left: 22.680412113%}
.wide.right .caption {margin-right: 22.680412113%}


.right {float: right;}
.left {float: left;}

div {
  margin: 0 auto;
  overflow: visible;
  position: relative;
}

.header {margin-top: 48px;margin-bottom: 72px}
.main {max-width: 60%;min-width: 600px}
.container {max-width: 1000px}
.entry {margin: 72px 0 120px}

.section .entry{margin: 5px 0 5px}

 

.margin {
  position: absolute;
  box-sizing: border-box;
  width: 29.3333%;
}

.margin blockquote {margin: 3px 0;color:#232323;padding: 3px 6px;font-size: 14px;line-height:18px;border: 1px solid rgba(0,0,0,0.1);border-left:4px solid rgba(0,0,0,0.2);background: rgba(0,0,0,0.05);}
.margin blockquote p {margin: 0}

.margin img,
.column img {margin-top: 6px}

.margin p {font-style: italic;font-family: "Avenir Next", "Avenir", Georgia;font-size: 0.9em;margin-top: 0}

.left.margin {
  left: -29.3333%;
  padding-right: 30px;
  text-align: right;
}

.right.margin {
  right: -29.3333%;
  padding-left: 30px;
}

.wide {
  width: 158.6666667%;
  margin-left: -29.3333333%;
  overflow: auto;  
}

.wide.left, .wide.right {width: 129.3333333%;float: none;}
.wide.left {margin: 0 0 0 -29.3333333%}
.wide.right {margin: 0 -29.3333333% 0 0}

.column {
  box-sizing: border-box;
  float: left;
}

.column .caption {margin-bottom: 6px}

.column.two {
  width: 50%;
  padding-right: 12px;
}

.column.three {
  width: 33%;
  padding-right: 24px;
}

.column.two + .column.two {
  padding: 0 0 0 12px;
}

.column h1,
.column h2,
.column h3 {margin-bottom: -12px}

 

p, li {
  font-family: "Avenir Next", "Avenir", Georgia, serif;
  position: relative;
  margin: 24px 0;
}

h1 {
  font-size: 25px;
  line-height: 36px;
  font-weight: 400;
  margin-bottom: 24px}

h2, h3, h4, h5, h6 {
  font-size: 17px;
  font-weight: 600;
  line-height: 24px;
  margin: 48px 0 24px}

h1 a, h2 a, h3 a, h4 a, h5, h6 a {
  color: rgb(35, 35, 35);
  background-image: none;
}


blockquote {
  padding: 0 0 0 12px;
  color: #777;
  border-left: 1px solid #777;
}

p .small-caps,
li .small-caps {
  font-size: 0.9em;
  line-height: 1em;
  letter-spacing: 0.02em;
}

b, strong { 
  font-weight: 600;
}

 

big {color: #000;font-size: 32px;font-family: "Avenir Next", "Avenir", Georgia;line-height: 48px;display: block;}


.text-danger {
  color: #d9534f;
}

 

 
.pull-double {margin-left:-0.45em}
.pull-single {margin-left:-.20em}

.push-single {margin-right:.20em}
.push-double {margin-right:0.45em}

 

a {
  color: #004984;  
  text-decoration: none;
  text-shadow: .03em 0 #fff, -.03em 0 #fff, 0 .03em #fff, 0 -.03em #fff, .06em 0 #fff, -.06em 0 #fff, .09em 0 #fff, -.09em 0 #fff, .12em 0 #fff, -.12em 0 #fff, 0 0.03em #fff, 0 -.03em #fff, 0 .06em #fff, 0 -.06em #fff, 0 .08em #fff, 0 -.08em #fff;
  background-image: linear-gradient(#fff, #fff), linear-gradient(#fff, #fff), linear-gradient(#004984, #004984);
  background-size: 0 0,0 0,0.07em 0.07em;
  background-repeat: no-repeat, no-repeat, repeat-x;
  background-position: 0% 90%, 100% 90%, 0% 95%;
}

a:hover {
  opacity: 0.8;
  background-image: linear-gradient(#fff, #fff), linear-gradient(#fff, #fff), linear-gradient(#5599D2, #5599D2);
}

a::selection {
  background: #b3d4fd;
  text-shadow: .03em 0 #b3d4fd, -.03em 0 #b3d4fd, 0 .03em #b3d4fd, 0 -.03em #b3d4fd, .06em 0 #b3d4fd, -.06em 0 #b3d4fd, .09em 0 #b3d4fd, -.09em 0 #b3d4fd, .12em 0 #b3d4fd, -.12em 0 #b3d4fd;
}

a::-moz-selection {
  background: #b3d4fd;
  text-shadow: .03em 0 #b3d4fd, -.03em 0 #b3d4fd, 0 .03em #b3d4fd, 0 -.03em #b3d4fd, .06em 0 #b3d4fd, -.06em 0 #b3d4fd, .09em 0 #b3d4fd, -.09em 0 #b3d4fd, .12em 0 #b3d4fd, -.12em 0 #b3d4fd;
}

h1 a {
  background-size: 0 0,0 0,0.07em 0.07em;
  background-position: 0% 90%, 100% 90%, 0% 98%;
}

h2 a, h3 a, h4 a, h5 a, h6 a {
  background-size: 0 0,0 0,0.07em 0.07em;
  background-position: 0% 90%, 100% 90%, 0% 97%;
}


 

hr {width: 100%;margin: 24px auto -1px;border: none;border-bottom: 3px double #efefef; padding-bottom: 1.4em;text-shadow: none;box-shadow: none;}

 

code {
  font-family:  Menlo, Consolas, "Liberation Mono", Courier, monospace;
  margin: 0;
  font-size: 85%;
  background: rgba(0,0,0,.03);
  border-radius: 3px;
  line-height: 24px;
}

p code {
  line-height: 1em;
  padding: 2px;
  margin-left: -2px;
  display: inline-block;
}

p code.has-jax {
  background-color: transparent;
  padding-left: .5em;
  padding-right: .5em;
}
 

pre code {
  display: block;padding: 12px 18px;
  background-color: rgba(0,0,0,.02);
  border-radius: 1em;
}

 

table {
  display: block;
  width: auto;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
  border-collapse: collapse;
  border-spacing: 0;
  box-sizing: border-box;
  font-size: 15px;
  line-height: 24px;
}

tr {box-sizing: border-box;border-top: 1px solid #ccc;padding: 0}
th, td {box-sizing: border-box;border: 1px solid #ddd;padding: 5px 12px 6px}

 

ul, ol {
  margin-left: 1.5em;
  padding-left: 0;
  list-style-position: outside;
  margin-bottom: 24px;
}

ul {list-style: circle;}

ul ul, ol ul, ol ol, ul ol {margin-left: 1.33em;margin-bottom: 0}

li {margin: 0}

 

img {
  vertical-align: middle;
  max-width: 100%;
  height: auto;
  }

.image {
  position: relative;
  height: 0;
  padding: 0 0 35.504201681%;
  max-width: 100%;
  margin: 0 auto;
  display: block;
}

.image img {width: 100%}

.image_container {display: block}


.wide .image_container {margin: 0 auto}
.wide p {margin-top: 0}

 

iframe {width: 100%;}

 
.entry > iframe {margin: 24px 0!important;}

 

.entry .twitter-tweet {margin-left:-16px!important}

 

.katex  {font-size: 1.05em;}



#logo {
  font-weight: bold;
  display:block;
  font-size: 20px;
  color: #111111;
  position: relative;
  text-shadow: none;
  background-image: none;
}


#logo img {position: absolute;width: 48px;top: 0px;left: -62px;}

#logo:hover {color: #555}
#logo img:hover {opacity: 0.8}

#logo img.rounded {width: 52px;border-radius: 50%;top: -2px;left: -64px}
#logo img:active {margin-top: 1px}

 
.nav {line-height: 20px;padding-bottom: 4px}
.nav a {margin-right: 6px;font-size: 14px;background: none;text-shadow: none;}

a.feed,
a.search {
  color: #000;
  font-weight: 500;
  font-size: 13px;
  padding-left: 1.25em;
  background: url('data:image/svg+xml;base64,PHN2ZyBpZD0iaWNvbi1icm9hZGNhc3QiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTIwIDEyMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Y2lyY2xlIGN4PSIxOC4zODUiIGN5PSIxMDEuNjE1IiByPSIxOC4zODUiLz4NCjxnPg0KCTxwYXRoIGQ9Ik0tMS4wMzEsNjFjMzIuNTMzLDAsNTksMjYuNDY4LDU5LDU5cy0yNi40NjcsNTktNTksNTlzLTU5LTI2LjQ2OC01OS01OVMtMzMuNTY0LDYxLTEuMDMxLDYxIE0tMS4wMzEsMzgNCgkJYy00NS4yODgsMC04MiwzNi43MTMtODIsODJzMzYuNzEyLDgyLDgyLDgyczgyLTM2LjcxMyw4Mi04MlM0NC4yNTcsMzgtMS4wMzEsMzhMLTEuMDMxLDM4eiIvPg0KPC9nPg0KPGc+DQoJPHBhdGggZD0iTTAuMTU0LDIzLjA0MWM1My4zNDksMCw5Ni43NSw0My40MDIsOTYuNzUsOTYuNzVzLTQzLjQwMiw5Ni43NS05Ni43NSw5Ni43NWMtNTMuMzQ4LDAtOTYuNzUtNDMuNDAyLTk2Ljc1LTk2Ljc1DQoJCVMtNTMuMTk0LDIzLjA0MSwwLjE1NCwyMy4wNDEgTTAuMTU0LDAuMDQxYy02Ni4xMzYsMC0xMTkuNzUsNTMuNjE1LTExOS43NSwxMTkuNzVzNTMuNjE0LDExOS43NSwxMTkuNzUsMTE5Ljc1DQoJCWM2Ni4xMzUsMCwxMTkuNzUtNTMuNjE1LDExOS43NS0xMTkuNzVTNjYuMjg5LDAuMDQxLDAuMTU0LDAuMDQxTDAuMTU0LDAuMDQxeiIvPg0KPC9nPg0KPC9zdmc+') no-repeat left center / 100%;
  background-size: 0.88em;
  opacity: 0.4;
  margin-left: 1em
}

a.search {
  background-image: url(data:image/svg+xml;base64,PHN2ZyBpZD0iaWNvbi1zZWFyY2giIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgOCA4IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwYXRoIGlkPSJzZWFyY2giIGQ9Ik03Ljk5LDYuOTI4TDUuODQ3LDQuNzg0YzAuMjg5LTAuNDc2LDAuNDU4LTEuMDMzLDAuNDU4LTEuNjNDNi4zMDUsMS40MTIsNC44OTUsMCwzLjE1MiwwDQoJQzEuNDExLDAsMCwxLjQxMiwwLDMuMTU0YzAsMS43NDEsMS40MTIsMy4xNTEsMy4xNTMsMy4xNTFjMC41OTcsMCwxLjE1NC0wLjE2OSwxLjYzLTAuNDU4bDIuMTQ1LDIuMTQ2TDcuOTksNi45Mjh6IE0xLjIwMywzLjE1NA0KCWMwLjAwMi0xLjA3NywwLjg3NC0xLjk0OSwxLjk1MS0xLjk1MWMxLjA3NiwwLjAwMiwxLjk0OCwwLjg3NCwxLjk0OSwxLjk1MUM1LjEwMSw0LjIzLDQuMjI5LDUuMTAzLDMuMTUzLDUuMTAzDQoJQzIuMDc1LDUuMTAzLDEuMjA1LDQuMjMsMS4yMDMsMy4xNTR6Ii8+DQo8L3N2Zz4=);
  background-size: 0.94em;
}

a.feed:hover,
a.search:hover {opacity: 1}

input#search {
  font-size: 1.2em;
  padding: .5em 1em .5em 2.3em;
  background: url(data:image/svg+xml;base64,PHN2ZyBpZD0iaWNvbi1zZWFyY2giIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgOCA4IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwYXRoIGlkPSJzZWFyY2giIGQ9Ik03Ljk5LDYuOTI4TDUuODQ3LDQuNzg0YzAuMjg5LTAuNDc2LDAuNDU4LTEuMDMzLDAuNDU4LTEuNjNDNi4zMDUsMS40MTIsNC44OTUsMCwzLjE1MiwwDQoJQzEuNDExLDAsMCwxLjQxMiwwLDMuMTU0YzAsMS43NDEsMS40MTIsMy4xNTEsMy4xNTMsMy4xNTFjMC41OTcsMCwxLjE1NC0wLjE2OSwxLjYzLTAuNDU4bDIuMTQ1LDIuMTQ2TDcuOTksNi45Mjh6IE0xLjIwMywzLjE1NA0KCWMwLjAwMi0xLjA3NywwLjg3NC0xLjk0OSwxLjk1MS0xLjk1MWMxLjA3NiwwLjAwMiwxLjk0OCwwLjg3NCwxLjk0OSwxLjk1MUM1LjEwMSw0LjIzLDQuMjI5LDUuMTAzLDMuMTUzLDUuMTAzDQoJQzIuMDc1LDUuMTAzLDEuMjA1LDQuMjMsMS4yMDMsMy4xNTR6Ii8+DQo8L3N2Zz4=) 1em center/0.8em no-repeat;
  border-radius: 3em;
  width: 103.5%;
  box-sizing: border-box;
  margin: .33em .66em 2em -1em;
  border: 1px solid #A1ADB6;
  font-family: "Avenir Next", "Avenir", "Helvetica Neue",Helvetica,Arial,sans-serif;
}

input#search:focus {
  outline: none;
  box-shadow: 0 0 5px rgba(100, 169, 226, 0.51);
  border: 1px solid #A1ADB6;
}

::-webkit-input-placeholder {
   color: #A4A9B0;
}

:-moz-placeholder {  
   color: #A4A9B0;
}

::-moz-placeholder {   
   color: #A4A9B0;
}

:-ms-input-placeholder {
   color: #A4A9B0;
}

.date {margin-top: 10px;background: none;text-shadow: none;}
.date:empty {display: none;}

 
.entry .date + p,
.entry .date + ul,
.entry .date + ol {position: relative;top: 9px;padding-bottom: 9px}

.entry .date + .wide {position: relative;top: 2.66em;padding-bottom: 2.66em}
.entry .date + .wide.right {position: relative;top: 0.66em;padding-bottom: 0.66em}
.entry .date + h2,
.entry .date + h3,
.entry .date + h4,
.entry .date + h5,
.entry .date + h6
 {position: relative;top: 9px;}

 
.pagination {
  text-align: center;
  margin: 72px 0 144px;
  font-size: 14px;color: #999
}

.pagination a {margin: 0 1em;background: none}

.previousEntry,
.nextEntry {
  text-decoration: none;
  background: none;
  text-shadow: none;
  font-size: 0.88em;
  line-height: 1.33em;
  width: 48%;
  margin: 1em 0 6em 2%;
  color: #000;
  display: block;
  float: left;
}

.previousEntry {margin: 1em 2% 6em 0;}

.adjacent a h5 {margin-bottom: 3px;color: #000}
.adjacent a .summary {color: #6B6B6B;font-size: 13px;line-height: 17px;}

.previousEntry .title,
.nextEntry .title {
  display: block;
  font-size: 1.156em;
  font-family: sans-serif;
  line-height: 20px;
  margin-bottom: 3px
}

a.tag {
  padding-left: 1.33em;
  margin-right: 1em;
  background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaGVpZ2h0PSIyMnB4IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyMyAyMiIgd2lkdGg9IjIzcHgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48dGl0bGUvPjxkZWZzPjxwYXRoIGQ9Ik0xMy4xMjgwNzM4LC0xLjg2ODA4NjcyIEw2LDQuMjk4NjQzMjcgTDYsMTkuNTY2ODc3NSBDNiwxOS44MzY4NjU4IDYuMjIzNjgyNiwyMC4wNTU3MzQ1IDYuNDk5MDc2ODUsMjAuMDU1NzM0NSBMMjAuNTAwOTIzMiwyMC4wNTU3MzQ1IEMyMC43NzY1NTU3LDIwLjA1NTczNDUgMjEsMTkuODMyOTg3MyAyMSwxOS41NjY4Nzc1IEwyMSw0LjI5ODY0MzI3IEwxMy44NzE5MjYyLC0xLjg2ODA4NjcyIEMxMy42NjY1MTcxLC0yLjA0NTc5MjkgMTMuMzI5MjYwNCwtMi4wNDIxMzk4MSAxMy4xMjgwNzM4LC0xLjg2ODA4NjcyIFogTTEzLjUsNy44MzM1MTIzMiBDMTQuNjA0NTY5Niw3LjgzMzUxMjMyIDE1LjUsNi45NTc5ODAzMiAxNS41LDUuODc3OTU2NzYgQzE1LjUsNC43OTc5MzMyMSAxNC42MDQ1Njk2LDMuOTIyNDAxMjEgMTMuNSwzLjkyMjQwMTIxIEMxMi4zOTU0MzA1LDMuOTIyNDAxMjEgMTEuNSw0Ljc5NzkzMzIxIDExLjUsNS44Nzc5NTY3NiBDMTEuNSw2Ljk1Nzk4MDMyIDEyLjM5NTQzMDUsNy44MzM1MTIzMiAxMy41LDcuODMzNTEyMzIgTDEzLjUsNy44MzM1MTIzMiBaIiBpZD0icGF0aC0xIi8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgaWQ9Im1pdSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiPjxnIGlkPSJjb21tb25fdGFnXzJfZ2VuZXJhbF9wcmljZV9nbHlwaCI+PHVzZSBmaWxsPSIjOTk5OTk5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzLjUwMDAwMCwgOS4wMDAwMDApIHJvdGF0ZSg0NS4wMDAwMDApIHRyYW5zbGF0ZSgtMTMuNTAwMDAwLCAtOS4wMDAwMDApICIgeGxpbms6aHJlZj0iI3BhdGgtMSIvPjx1c2UgZmlsbD0ibm9uZSIgeGxpbms6aHJlZj0iI3BhdGgtMSIvPjwvZz48L2c+PC9zdmc+) left center/0.94em no-repeat;
}


@media screen and (max-width: 976px) {

  .main {max-width: 600px;min-width: 0}

  .entry .margin {position: relative;top: auto;left: auto;right: auto;bottom: auto;}

  .entry .margin.right {
    float: right;
  }

  .entry .margin.left {
    text-align: left;
    display: block;
    float: left;
  }

  .entry .date {width: 100%;}

  .entry .margin .caption,
  .entry .margin p {margin-bottom: 6px;text-align: left;}

  .wide, .wide.left, .wide.right {width: 100%;margin: 0}
  .wide.left .caption {margin-left: 0}

  .date {position: absolute;top: -24px;left: 0;text-align: left;margin: 0}
}

@media screen and (max-width: 730px) {
  body {font-size: 90%;}
  .nav, #logo {margin-left: 60px}
  ul, li {margin-left: 24px}
  ul ul, ol ul, ol ol, ul ol {margin-left: 0}
  .nav .right {clear: both;float: none;margin-top: 3px}
  a.search {margin-left: 0}
}

@media screen and (max-width: 400px) {
  body {font-size: 80%;}
  .entry .twitter-tweet {margin-left: 0!important}
  .header {margin: 9px auto -12px}
}


 

.highlight code, .highlight pre{color:#fdce93;background-color:#3f3f3f}
.highlight .hll{background-color:#222}
.highlight .c{color:#7f9f7f}
.highlight .err{color:#e37170;background-color:#3d3535}
.highlight .g{color:#7f9f7f}
.highlight .k{color:#f0dfaf}
.highlight .l{color:#ccc}
.highlight .n{color:#dcdccc}
.highlight .o{color:#f0efd0}
.highlight .x{color:#ccc}
.highlight .p{color:#41706f}
.highlight .cm{color:#7f9f7f}
.highlight .cp{color:#7f9f7f}
.highlight .c1{color:#7f9f7f}
.highlight .cs{color:#cd0000;font-weight:bold}
.highlight .gd{color:#cd0000}
.highlight .ge{color:#ccc;font-style:italic}
.highlight .gr{color:red}
.highlight .gh{color:#dcdccc;font-weight:bold}
.highlight .gi{color:#00cd00}
.highlight .go{color:gray}
.highlight .gp{color:#dcdccc;font-weight:bold}
.highlight .gs{color:#ccc;font-weight:bold}
.highlight .gu{color:purple;font-weight:bold}
.highlight .gt{color:#0040D0}
.highlight .kc{color:#dca3a3}
.highlight .kd{color:#ffff86}
.highlight .kn{color:#dfaf8f;font-weight:bold}
.highlight .kp{color:#cdcf99}
.highlight .kr{color:#cdcd00}
.highlight .kt{color:#00cd00}
.highlight .ld{color:#cc9393}
.highlight .m{color:#8cd0d3}
.highlight .s{color:#cc9393}
.highlight .na{color:#9ac39f}
.highlight .nb{color:#efef8f}
.highlight .nc{color:#efef8f}
.highlight .no{color:#ccc}
.highlight .nd{color:#ccc}
.highlight .ni{color:#c28182}
.highlight .ne{color:#c3bf9f;font-weight:bold}
.highlight .nf{color:#efef8f}
.highlight .nl{color:#ccc}
.highlight .nn{color:#8fbede}
.highlight .nx{color:#ccc}
.highlight .py{color:#ccc}
.highlight .nt{color:#9ac39f}
.highlight .nv{color:#dcdccc}
.highlight .ow{color:#f0efd0}
.highlight .w{color:#ccc}
.highlight .mf{color:#8cd0d3}
.highlight .mh{color:#8cd0d3}
.highlight .mi{color:#8cd0d3}
.highlight .mo{color:#8cd0d3}
.highlight .sb{color:#cc9393}
.highlight .sc{color:#cc9393}
.highlight .sd{color:#cc9393}
.highlight .s2{color:#cc9393}
.highlight .se{color:#cc9393}
.highlight .sh{color:#cc9393}
.highlight .si{color:#cc9393}
.highlight .sx{color:#cc9393}
.highlight .sr{color:#cc9393}
.highlight .s1{color:#cc9393}
.highlight .ss{color:#cc9393}
.highlight .bp{color:#efef8f}
.highlight .vc{color:#efef8f}
.highlight .vg{color:#dcdccc}
.highlight .vi{color:#ffffc7}
.highlight .il{color:#8cd0d3}


</style>


    <link rel="shortcut icon" href="/favicon.ico">

    

  </head>



  <body>
      

<div class="container header">
  <div class="main">
    <a id="logo" href="/">
      <img class="avatar rounded" src="/images/lee-avatar-256-low.jpg" alt="__name__'s avatar" />
      
    </a>
    <div class="nav">
      
        <a href="/archives/">Archives</a>
      
        <a href="/">Home</a>
      

      <div class="right">
        
        
        
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <div class="main">
        <div class="entry">

<a class="small date left margin" href="/2017/03/29/how-i-extended-markdown-for-hugo/">March 2017</a>
<h1 id="layout-typography"> How I Extended Markdown for Hugo  <a class="small permalink" href="/2017/03/29/how-i-extended-markdown-for-hugo/">#</a></h1>


  


























<p>I extended Markdown beyond what is provided by Hugo&rsquo;s various standard rendering options. My requirements were:</p>

<ul>
<li>Be Markdown-flavored. Use generic Hugo with <strong>No Shortcodes</strong></li>
<li>Automatically increment Heading Levels</li>
<li>Styled Blocks</li>
<li>Easy Media Insertion</li>
<li>Font Awesome Icons Insertion</li>
<li>Easy MathJax formatting</li>
</ul>

<p>I achieved my goals using a layout partial template that is called in place of <code>.Content</code>. I will describe each of these features below, and discuss my concerns with this approach, and provide the code.</p>

<h2 id="be-markdown-flavored-use-generic-hugo-with-no-shortcodes">Be Markdown-flavored. Use generic Hugo with No Shortcodes</h2>

<p><strong>Requirement:</strong> Use only standard Markdown or new syntax that is inspired by the ideals of Markdown.</p>

<p><strong>Rational:</strong> As much as possible writers should use John Gruber&rsquo;s original <a href="http://daringfireball.net/projects/markdown/syntax">Markdown</a>,  However while Markdown covers the basics of writing for the web, it does not cover the needs of all writers. Hugo via <a href="https://github.com/russross/blackfriday#extensions">Blackfriday</a> supports various extensions to Markdown such as tables and definition lists. Still there are many extensions that Blackfriday does not currently support. Additionally, one of the inspiring aspects of Markdown has been the ability of each writer or community to adapt it to their own needs.</p>

<p>The Hugo communities approach to extending Markdown support has been to allow the use of a handful of <a href="https://gohugo.io/content/supported-formats/">eternal formats</a> or <a href="https://gohugo.io/extras/shortcodes/">shortcodes</a></p>

<ul>
<li>External formats require additional installation and configuration, and provide limited additional flexibility.</li>
<li>Shortcodes while very powerful are a &ldquo;mark<strong>up</strong>&rdquo; syntax and are decidedly <strong>not</strong> in the spirit of Markdown.</li>
<li>While shortcodes can contain Markdown, they unfortunately loose the context of the current page so that features such as <a href="https://discuss.gohugo.io/t/markdown-reference-links-in-shortcodes/5770">reference links break</a></li>
</ul>

<p>Finally, this should be done using a generic standard build of Hugo. It should work anywhere: your local machine, a server, a service such as <a href="http://netlify.com">netlify.com</a>. (Currently, I am using pygments for syntax highlighing, but I am concidering removal of this dependancy.)</p>

<h2 id="increment-headings">Increment Headings</h2>

<p><strong>Requirement:</strong> Increment all headings by one level. The markdown <code># My Heading</code> will be rendered as <code>&lt;h2&gt;My Heading&lt;/h2&gt;</code></p>

<p><strong>Rational:</strong> Content headings should be treated as relative to their context. The page Front Mater &lsquo;Titles&rsquo; will become <code>&lt;H1&gt;</code> heading, and the content headings to be under it. For simplicity for writers and compatibility with editing tools, markdown content headings should start with <code>#</code> and be incremented by the renderer.</p>

<h2 id="styled-blocks">Styled Blocks</h2>

<p><strong>Requirement:</strong> add Markdown syntax to provided stylized <code>&lt;div&gt;</code> blocks. The content of these blocks will be rendered as markdown. For example:</p>

<pre><code>::: alert red
This is a **Red Alert!** Take cover.
:::
</code></pre>

<p>results in:</p>

<pre><code>&lt;div class=&quot;alert red&quot;&gt;
This is a **Red Alert!** Take cover. 
&lt;/div&gt;
</code></pre>

<p><strong>Rational:</strong> plain Markdown lacks the option for anything except very basic formatting. This provides for almost unlimited flexibility of adding content related container layout. The <code>:::</code> syntax is taken from <a href="https://github.com/markdown-it/markdown-it-container">markdown-it-container</a> and has been discussed as a potential <a href="https://talk.commonmark.org/t/content-block-inline-syntax/815">extension to CommonMark</a></p>

<h2 id="easy-media-insertion">Easy Media Insertion</h2>

<p><strong>Requirement:</strong> recognize common embeddable media content</p>

<pre><code>&gt; https://vimeo.com/1234567
</code></pre>

<p>results in:</p>

<pre><code>&lt;div class='embed video-player'&gt;&lt;iframe src='https://player.vimeo.com/video/1234567' width='100%' height='385' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen&gt;&lt;/iframe&gt;&lt;/div&gt;
</code></pre>

<p><strong>Rational:</strong> make media insertion easy for writers with minimal extra syntax. In fact, we leverage the standard markdown blockquote so it works nicely in Markdown aware editors. Currently providing support for Vimeo and YouTube.</p>

<h2 id="font-awesome-icons">Font Awesome icons</h2>

<p>Allow the insertion of <a href="http://fontawesome.io">Font Awesome icons</a>. For example <code>:fa-camera-retro:</code> will result in:</p>

<pre><code>&lt;i class=&quot;fa fa-camera-retro&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;
</code></pre>

<p>You can add additional Font Awesome or other classes. <code>:fa-camera-retro fa-3x text-danger:</code></p>

<pre><code>&lt;i class=&quot;fa fa-camera-retro fa-3x text-danger&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;
</code></pre>

<p>Any required CSS or JS is automatically added to the page without need to add site-wide or in the front matter.</p>

<h2 id="easy-mathjax-formatting">Easy MathJax formatting</h2>

<p><strong>Requirement:</strong> support for <a href="https://www.mathjax.org">MathJax</a> that is friendly to writers</p>

<p>Recognize math inline <code>\$ x^2 $\</code> and block</p>

<blockquote>
<p>$$  x^2  $$</p>
</blockquote>

<p>and apply the appropriate tags and javascript.</p>

<p>Any required CSS or JS is automatically added to the page without need to add site-wide or in the front matter.</p>

<h2 id="issues-with-this-approach">Issues with this approach</h2>

<p>This is a hack to force Hugo to do things it is not setup to do.</p>

<ul>
<li><p>Code Fences<br />
I want to able to use Code Fences; however, my approach has some conflicts. Still working&hellip;</p></li>

<li><p>No Shortcodes Allowed
Shortcodes are not processed by .RawContent or markdownify. While we are intentionally avoiding the common uses of Hugo&rsquo;s shortcodes, this approach prevents you from using them in content for any reason. For my use cases, I don&rsquo;t see this as an issue. I however, I would prefer to not disable Shortcodes entirely.</p></li>

<li><p>The regular expressions in Go are a little limited. It does not
recognize start of line ^ and end of line<b>so I am using \n to look for line</b>
breaks. There is no support for Negative lookahead, which makes it difficult
to catch cases such as escape codes. Some of this maybe my lack of knowledge
of the Go language.</p></li>

<li><p>Forces the use of safeHTML<br />
I am not entirely sure if this is introducing a safety issue here? Some requirement of trusting the content. Ideally Hugo will implement a <code>sanatizeHTML</code> function.
Need to track: <a href="https://github.com/spf13/hugo/issues/1457">https://github.com/spf13/hugo/issues/1457</a></p></li>

<li><p>Need to replace all instances of <code>.Content</code> in templates with my layout partial template.</p></li>

<li><p>How much of a performance hit is this? Should I be using <code>.partialCached</code>? (Remember this is being applied to every page on the site.)</p></li>
</ul>

<h2 id="how-to-use">How to use</h2>

<p>In your templates replace <code>.Content</code> with <code>.contentMarkdownCustom</code>. Create the partial template <code>contentMarkdownCustom.html</code> and add this code:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">{{ $s := .RawContent }}
{{ $s :=  delimit (slice &#34;\n&#34; $s &#34;\n&#34;) &#34;&#34; }}

{{ $s :=  $s | replaceRE &#34;\n(#+) &#34; &#34;\n#$1 &#34; }}

{{ $s :=  $s | replaceRE &#34;\n::: *\n&#34; &#34;\n\n«MDBLOCK-END»\n\n&#34; }}
{{ $s :=  $s | replaceRE &#34;\n::: ([a-z0-9 ]*)\n&#34; &#34;\n\n«MDBLOCK-class-$1»\n\n&#34; }}

{{ $s :=  $s | replaceRE &#34;\n&gt; https?://vimeo[.]com/([0-9]*) *\n&#34; &#34;\n\n<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;embed video-player&#39;</span><span class="p">&gt;&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;https://player.vimeo.com/video/$1&#39;</span> <span class="na">width</span><span class="o">=</span><span class="s">&#39;100%&#39;</span> <span class="na">height</span><span class="o">=</span><span class="s">&#39;385&#39;</span> <span class="na">frameborder</span><span class="o">=</span><span class="s">&#39;0&#39;</span> <span class="na">webkitAllowFullScreen</span> <span class="na">mozallowfullscreen</span> <span class="na">allowFullScreen</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n\n&#34; }}
{{ $s :=  $s | replaceRE &#34;\n&gt; https://youtu.be/([a-zA-Z0-9]*)&#34; &#34;\n\n<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;embed video-player&#39;</span><span class="p">&gt;&lt;</span><span class="nt">iframe</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;youtube-player&#39;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;text/html&#39;</span> <span class="na">width</span><span class="o">=</span><span class="s">&#39;640&#39;</span> <span class="na">height</span><span class="o">=</span><span class="s">&#39;385&#39;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;http://www.youtube.com/embed/$1&#39;</span> <span class="na">allowfullscreen</span> <span class="na">frameborder</span><span class="o">=</span><span class="s">&#39;0&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n\n&#34; }}

{{ $s :=  $s | replaceRE &#34;\n([$][$].*[$][$])&#34; &#34;\n\n<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;mathFormat&#39;</span><span class="p">&gt;</span>$1<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n\n&#34;}}
{{ $s :=  $s | replaceRE &#34;\n[`]([$].*[$])[`]&#34; &#34;\n\n<span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;mathFormat&#39;</span><span class="p">&gt;</span>$1<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>\n\n&#34;}}

{{ $s :=  $s | replaceRE &#34;([^`]):(fa-[a-z0-9 -]*):&#34; &#34;$1<span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;fa $2&#39;</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">&#39;true&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span>&#34; }}

{{ $s :=  $s | markdownify }}
{{ $s :=  $s | replaceRE &#34;<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>«MDBLOCK-END»<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>&#34; &#34;<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>&#34;  }}
{{ $s :=  $s | replaceRE &#34;<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>«MDBLOCK-class-([^»]*)»<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>&#34; &#34;<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;$1&#39;</span> <span class="p">&gt;</span>&#34; }}
{{/* 

  Ideally we would use `sanatizeHTML` and note `safeHTML`. Hopefully `sanatizeHTML` will happen. 
  Need to track: https://github.com/spf13/hugo/issues/1457

*/}}
{{ $s :=  $s | safeHTML }}

{{- $s -}}



{{ $hasMathFormat := findRE &#34;<span class="err">&lt;</span>(div|span) class=&#39;mathFormat&#39;&gt;&#34; $s }}
{{ if ge (len $hasMathFormat) 1 }}

  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span>
    <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/x-mathjax-config&#34;</span><span class="p">&gt;</span>
  <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">Config</span><span class="p">({</span>
    <span class="nx">tex2jax</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">inlineMath</span><span class="o">:</span> <span class="p">[[</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;$&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;\\(&#39;</span><span class="p">,</span><span class="s1">&#39;\\)&#39;</span><span class="p">]],</span>
      <span class="nx">displayMath</span><span class="o">:</span> <span class="p">[[</span><span class="s1">&#39;$$&#39;</span><span class="p">,</span><span class="s1">&#39;$$&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;\[&#39;</span><span class="p">,</span><span class="s1">&#39;\]&#39;</span><span class="p">]],</span>
      <span class="nx">processEscapes</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">processEnvironments</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">skipTags</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;script&#39;</span><span class="p">,</span> <span class="s1">&#39;noscript&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;textarea&#39;</span><span class="p">,</span> <span class="s1">&#39;pre&#39;</span><span class="p">],</span>
      <span class="nx">TeX</span><span class="o">:</span> <span class="p">{</span> <span class="nx">equationNumbers</span><span class="o">:</span> <span class="p">{</span> <span class="nx">autoNumber</span><span class="o">:</span> <span class="s2">&#34;AMS&#34;</span> <span class="p">},</span>
           <span class="nx">extensions</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;AMSmath.js&#34;</span><span class="p">,</span> <span class="s2">&#34;AMSsymbols.js&#34;</span><span class="p">]</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>
  <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/x-mathjax-config&#34;</span><span class="p">&gt;</span>
    <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">Queue</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// Fix &lt;code&gt; tags after MathJax finishes running. This is a
</span><span class="c1"></span>      <span class="c1">// hack to overcome a shortcoming of Markdown. Discussion at
</span><span class="c1"></span>      <span class="c1">// https://github.com/mojombo/jekyll/issues/199
</span><span class="c1"></span>      <span class="kd">var</span> <span class="nx">all</span> <span class="o">=</span> <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">getAllJax</span><span class="p">(),</span> <span class="nx">i</span><span class="p">;</span>
      <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">all</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">all</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">SourceElement</span><span class="p">().</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; has-jax&#39;</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">});</span>
  <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

{{ end }}


{{ $hasFontAwesome := findRE &#34;<span class="p">&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;fa</span> <span class="na">fa-</span><span class="err">&#34;</span> <span class="err">$</span><span class="na">s</span> <span class="err">}}</span>

<span class="err">{{</span> <span class="na">if</span> <span class="na">ge</span> <span class="err">(</span><span class="na">len</span> <span class="err">$</span><span class="na">hasFontAwesome</span><span class="err">)</span> <span class="na">1</span> <span class="err">}}</span>
    <span class="err">&lt;</span><span class="na">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://use.fontawesome.com/53dd1f1274.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
{{ end }}</code></pre></div>






     
  

  
  <div id=links>
   <hr class="full" />
         
    
       <a class="halfWidth left previousEntry" href="/2017/02/05/markdown-block-formats/">
            <h5>Previous post</h5>
            <span class="title">Markdown Block Formats</span>
          </a>    
    
    
  </div>
    
</div>

  </div>
  
</body>
</html>





